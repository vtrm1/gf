<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Salão - Painel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-body: #f7f1e8;
      --bg-card: #fffaf3;
      --bg-sidebar: #f0e2cf;
      --accent-gold: #d4af37;
      --accent-gold-dark: #b38f1f;
      --text-main: #4b3c2f;
      --text-muted: #8a7a69;
      --border-soft: #e3d3c0;
      --danger: #d9534f;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: radial-gradient(circle at top, #fff8ee 0, #f7f1e8 40%, #f3e9dc 100%);
      color: var(--text-main);
      min-height: 100vh;
    }

    h1, h2, h3 {
      font-weight: 600;
      letter-spacing: 0.03em;
    }

    button {
      cursor: pointer;
      border: none;
      border-radius: 999px;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      transition: all 0.2s ease;
      background: var(--accent-gold);
      color: white;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    button:hover {
      background: var(--accent-gold-dark);
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }

    button.secondary {
      background: transparent;
      color: var(--accent-gold-dark);
      border: 1px solid var(--accent-gold);
      box-shadow: none;
    }

    button.secondary:hover {
      background: rgba(212, 175, 55, 0.08);
    }

    .segmented {
      display: inline-flex;
      background: rgba(212, 175, 55, 0.1);
      border-radius: 999px;
      padding: 0.15rem;
      gap: 0.15rem;
    }

    .segmented button {
      background: transparent;
      color: var(--accent-gold-dark);
      box-shadow: none;
      padding: 0.35rem 0.8rem;
      border-radius: 999px;
      border: 1px solid transparent;
      font-size: 0.85rem;
    }

    .segmented button.active {
      background: #fffaf3;
      border-color: rgba(212, 175, 55, 0.6);
      color: var(--text-main);
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    }

    .tag {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.1rem 0.6rem;
      border-radius: 999px;
      font-size: 0.75rem;
      background: rgba(212, 175, 55, 0.1);
      color: var(--accent-gold-dark);
    }

    .app-shell {
      display: flex;
      min-height: 100vh;
    }

    .sidebar {
      width: 250px;
      background: linear-gradient(180deg, #f0e2cf 0%, #e7d5c0 100%);
      border-right: 1px solid var(--border-soft);
      padding: 1.5rem 1rem;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .sidebar-header {
      display: flex;
      align-items: center;
      gap: 0.6rem;
    }

    .logo-circle {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #fff7e0, #d4af37);
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }

    .sidebar-nav {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      margin-top: 0.5rem;
    }

    .sidebar button.nav {
      width: 100%;
      justify-content: flex-start;
      border-radius: 999px;
      padding: 0.55rem 0.9rem;
      font-size: 0.85rem;
      background: transparent;
      color: var(--text-main);
      box-shadow: none;
      border: 1px solid transparent;
    }

    .sidebar button.nav.active {
      background: rgba(212, 175, 55, 0.18);
      border-color: rgba(212, 175, 55, 0.7);
      color: var(--accent-gold-dark);
    }

    .sidebar button.nav:hover {
      background: rgba(212, 175, 55, 0.12);
    }

    .sidebar-footer {
      margin-top: auto;
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .content {
      flex: 1;
      padding: 1.5rem 1.75rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 0.75rem;
    }

    .topbar h1 {
      font-size: 1.3rem;
    }

    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1rem;
    }

    .card {
      background: var(--bg-card);
      border-radius: 18px;
      padding: 1rem 1.1rem;
      box-shadow: 0 3px 12px rgba(0,0,0,0.06);
      border: 1px solid rgba(255,255,255,0.9);
    }

    .card h3 {
      font-size: 0.9rem;
      margin-bottom: 0.2rem;
      color: var(--text-muted);
    }

    .card .value {
      font-size: 1.3rem;
      font-weight: 600;
      margin-top: 0.1rem;
    }

    .subtext {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-top: 0.2rem;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      margin-top: 0.5rem;
    }

    .pill {
      padding: 0.2rem 0.6rem;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.05);
      font-size: 0.75rem;
      background: rgba(255,255,255,0.8);
    }

    .section-title {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 0.5rem;
      margin-bottom: 0.3rem;
    }

    .section-title h2 {
      font-size: 1rem;
    }

    .table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 0.4rem;
      font-size: 0.85rem;
    }

    .table th, .table td {
      text-align: left;
      padding: 0.5rem 0.4rem;
      border-bottom: 1px solid rgba(0,0,0,0.03);
    }

    .table th {
      font-weight: 500;
      color: var(--text-muted);
    }

    .badge {
      display: inline-block;
      padding: 0.15rem 0.5rem;
      border-radius: 999px;
      font-size: 0.7rem;
      background: rgba(0,0,0,0.04);
    }

    .calendar-year {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 0.9rem;
      margin-top: 0.5rem;
    }

    .month-card {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 0.7rem 0.8rem;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      cursor: pointer;
      border: 1px solid rgba(255,255,255,0.9);
      transition: transform 0.15s ease, box-shadow 0.15s ease, border-color 0.2s ease;
    }

    .month-card.active {
      border-color: rgba(212, 175, 55, 0.6);
      box-shadow: 0 4px 16px rgba(212, 175, 55, 0.12);
    }

    .month-card:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 14px rgba(0,0,0,0.08);
    }

    .month-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.2rem;
    }

    .month-name {
      font-size: 0.95rem;
      font-weight: 700;
    }

    .month-stat {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .month-bar {
      width: 100%;
      height: 6px;
      border-radius: 999px;
      background: rgba(0,0,0,0.04);
      overflow: hidden;
      margin-top: 0.3rem;
    }

    .month-bar-fill {
      height: 100%;
      border-radius: 999px;
      background: linear-gradient(90deg, #f7de9e, #d4af37);
      width: 40%;
    }

    .mini-calendar {
      margin-top: 0.5rem;
      border: 1px dashed rgba(0,0,0,0.06);
      border-radius: 12px;
      padding: 0.5rem;
      background: rgba(255,255,255,0.6);
    }

    .month-visual-toggle {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      flex-wrap: wrap;
    }

    .month-visual-toggle select {
      padding: 0.35rem 0.55rem;
      border-radius: 10px;
      border: 1px solid var(--border-soft);
      background: #fff;
      font-size: 0.9rem;
    }

    .full-month-calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 0.35rem;
      margin-top: 0.65rem;
      background: #fff;
      padding: 0.75rem;
      border-radius: 14px;
      border: 1px solid var(--border-soft);
      box-shadow: 0 4px 14px rgba(0,0,0,0.05);
    }

    .full-month-calendar .weekday {
      font-weight: 600;
      color: var(--text-muted);
      font-size: 0.85rem;
      text-align: center;
    }

    .full-month-calendar .month-day {
      height: 80px;
      border-radius: 12px;
      border: 1px solid var(--border-soft);
      background: linear-gradient(180deg, #fffaf3 0%, #fff 100%);
      padding: 0.4rem;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      font-size: 0.9rem;
      position: relative;
    }

    .full-month-calendar .month-day.has-booking {
      box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.35);
    }

    .full-month-calendar .month-day .day-number {
      font-weight: 600;
    }

    .full-month-calendar .month-day .day-badge {
      align-self: flex-start;
      font-size: 0.7rem;
      padding: 0.2rem 0.4rem;
      border-radius: 8px;
      background: rgba(212, 175, 55, 0.12);
      color: var(--accent-gold-dark);
    }

    .mini-weekdays,
    .mini-days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 0.25rem;
      font-size: 0.7rem;
      text-align: center;
    }

    .mini-weekdays span {
      color: var(--text-muted);
      font-weight: 600;
    }

    .mini-day {
      padding: 0.35rem 0;
      border-radius: 10px;
      background: rgba(0,0,0,0.02);
      position: relative;
    }

    .mini-day.empty {
      background: transparent;
    }

    .mini-day.has-booking {
      border: 1px solid rgba(212, 175, 55, 0.8);
      background: rgba(212, 175, 55, 0.08);
      font-weight: 700;
      color: var(--accent-gold-dark);
      box-shadow: 0 0 0 2px rgba(212, 175, 55, 0.15) inset;
    }

    .mini-day .dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--accent-gold);
      position: absolute;
      bottom: 4px;
      left: 50%;
      transform: translateX(-50%);
    }

    .month-footnote {
      margin-top: 0.35rem;
      font-size: 0.75rem;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .inventory-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.8rem;
      margin-bottom: 0.3rem;
      flex-wrap: wrap;
    }

    .inventory-tabs {
      display: inline-flex;
      background: rgba(212, 175, 55, 0.12);
      border-radius: 14px;
      padding: 0.2rem;
      gap: 0.2rem;
    }

    .inventory-tab {
      background: transparent;
      color: var(--text-muted);
      border: 1px solid transparent;
      border-radius: 12px;
      padding: 0.45rem 0.9rem;
      font-weight: 600;
      box-shadow: none;
    }

    .inventory-tab.active {
      background: #fffaf3;
      color: var(--text-main);
      border-color: rgba(212, 175, 55, 0.4);
      box-shadow: 0 2px 10px rgba(0,0,0,0.06);
    }

    .inventory-list {
      margin-top: 0.6rem;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1rem;
    }

    .inventory-card {
      position: relative;
      background: var(--bg-card);
      border-radius: 18px;
      padding: 1rem 1rem 0.9rem;
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
      border: 1px solid rgba(255,255,255,0.95);
      display: flex;
      flex-direction: column;
      gap: 0.65rem;
    }

    .inventory-badge {
      position: absolute;
      top: 0.8rem;
      right: 0.9rem;
      padding: 0.25rem 0.65rem;
      border-radius: 999px;
      font-size: 0.75rem;
      background: rgba(0,0,0,0.04);
      color: var(--text-muted);
    }

    .inventory-badge.low {
      background: rgba(217, 83, 79, 0.08);
      color: var(--danger);
    }

    .inventory-card-title {
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.01em;
    }

    .inventory-meta {
      font-size: 0.82rem;
      color: var(--text-muted);
      margin-top: 0.1rem;
    }

    .inventory-progress {
      width: 100%;
      height: 8px;
      border-radius: 999px;
      background: rgba(0,0,0,0.04);
      overflow: hidden;
    }

    .inventory-progress .fill {
      height: 100%;
      border-radius: 999px;
      background: linear-gradient(90deg, #f6e3b8, #d4af37);
      width: 70%;
    }

    .inventory-visibility {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.4rem;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .inventory-toggle {
      padding: 0.25rem 0.65rem;
      border-radius: 12px;
      border: 1px solid transparent;
      background: rgba(0,0,0,0.04);
      color: var(--text-muted);
      box-shadow: none;
      font-size: 0.78rem;
    }

    .inventory-toggle.active {
      background: rgba(212, 175, 55, 0.12);
      color: var(--accent-gold-dark);
      border-color: rgba(212, 175, 55, 0.35);
    }

    .inventory-foot {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.6rem;
    }

    .quantity-actions {
      display: inline-flex;
      gap: 0.35rem;
    }

    .quantity-actions button {
      width: 32px;
      height: 32px;
      padding: 0;
      border-radius: 10px;
      background: rgba(0,0,0,0.04);
      color: var(--text-main);
      box-shadow: none;
      border: 1px solid rgba(0,0,0,0.04);
    }

    .inventory-actions-icons {
      display: inline-flex;
      gap: 0.35rem;
      align-items: center;
    }

    .icon-button {
      width: 32px;
      height: 32px;
      padding: 0;
      border-radius: 10px;
      background: rgba(0,0,0,0.04);
      color: var(--text-muted);
      box-shadow: none;
      border: 1px solid rgba(0,0,0,0.04);
      font-size: 0.95rem;
    }

    .icon-button.danger {
      color: var(--danger);
    }

    .inventory-tabpanel {
      margin-top: 0.4rem;
    }

    .inventory-empty {
      padding: 0.8rem;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .inventory-modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.25);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      z-index: 10;
    }

    .inventory-modal .card {
      max-width: 520px;
      width: 100%;
      padding: 1.2rem 1.3rem;
    }

    .inventory-modal .modal-actions {
      display: flex;
      justify-content: flex-end;
      gap: 0.5rem;
      margin-top: 0.8rem;
    }

    .inventory-modal .modal-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 0.6rem;
      margin-top: 0.4rem;
    }

    .inventory-modal input {
      width: 100%;
      padding: 0.55rem 0.65rem;
      border-radius: 10px;
      border: 1px solid var(--border-soft);
      background: rgba(255,255,255,0.9);
    }

    .collab-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 0.8rem;
      margin-top: 0.6rem;
    }

    .collab-card {
      background: var(--bg-card);
      border-radius: 14px;
      padding: 0.9rem 1rem;
      box-shadow: 0 2px 10px rgba(0,0,0,0.06);
      border: 1px solid rgba(255,255,255,0.9);
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
    }

    .collab-headline {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .collab-avatar {
      width: 40px;
      height: 40px;
      border-radius: 12px;
      display: grid;
      place-items: center;
      color: white;
      font-weight: 700;
      background: linear-gradient(135deg, #e5c676, #b58c25);
    }

    .collab-meta {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .collab-actions {
      display: flex;
      gap: 0.35rem;
      flex-wrap: wrap;
    }

    .kiosk-wrapper {
      max-width: 900px;
      margin: 0 auto;
      padding: 1.25rem 1.5rem 1.5rem;
      background: radial-gradient(circle at 10% 20%, #fff7e6, #f0e7d8);
      border-radius: 22px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.08);
    }

    .kiosk-grid {
      display: grid;
      grid-template-columns: 1.8fr 1.1fr;
      gap: 1.1rem;
      margin-top: 1rem;
    }

    .kiosk-section-title {
      font-size: 1rem;
      margin-bottom: 0.3rem;
    }

    .kiosk-items {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 0.7rem;
    }

    .kiosk-card {
      background: var(--bg-card);
      border-radius: 18px;
      padding: 0.85rem 0.9rem;
      text-align: left;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      border: 1px solid rgba(255,255,255,0.95);
      position: relative;
      overflow: hidden;
    }

    .kiosk-card h3 {
      font-size: 0.9rem;
      margin-bottom: 0.25rem;
    }

    .kiosk-price {
      font-size: 1rem;
      font-weight: 700;
      margin-bottom: 0.35rem;
    }

    .kiosk-icon {
      width: 38px;
      height: 38px;
      border-radius: 12px;
      display: grid;
      place-items: center;
      font-size: 1.3rem;
      background: radial-gradient(circle at 30% 30%, #fff3d4, #f1d9a0);
      margin-bottom: 0.35rem;
    }

    .kiosk-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      padding: 0.25rem 0.55rem;
      border-radius: 999px;
      background: rgba(0,0,0,0.03);
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 0.2rem;
    }

    .kiosk-card::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(212, 175, 55, 0.09), transparent 50%);
      pointer-events: none;
    }

    .kiosk-cart {
      background: var(--bg-card);
      border-radius: 20px;
      padding: 1rem 1.1rem;
      box-shadow: 0 8px 24px rgba(0,0,0,0.08);
      border: 1px solid rgba(255,255,255,0.95);
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
      max-height: 520px;
    }

    .kiosk-cart-list {
      flex: 1;
      overflow-y: auto;
      margin-top: 0.3rem;
    }

    .kiosk-cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.45rem 0;
      border-bottom: 1px solid rgba(0,0,0,0.03);
      font-size: 0.85rem;
    }

    .kiosk-cart-total {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 0.5rem;
      font-weight: 600;
    }

    .kiosk-hero {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.8rem;
      flex-wrap: wrap;
    }

    .kiosk-steps {
      display: flex;
      gap: 0.4rem;
      flex-wrap: wrap;
      margin-top: 0.35rem;
    }

    .kiosk-pill {
      background: rgba(0,0,0,0.04);
      padding: 0.35rem 0.75rem;
      border-radius: 999px;
      font-size: 0.78rem;
      color: var(--text-muted);
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
    }

    .login-mode-toggle {
      display: flex;
      gap: 0.4rem;
      margin: 0.6rem 0;
      flex-wrap: wrap;
    }

    .login-tab {
      border-radius: 14px;
      padding: 0.5rem 0.9rem;
      background: rgba(0,0,0,0.03);
      border: 1px solid transparent;
      cursor: pointer;
      font-weight: 600;
      color: var(--text-muted);
    }

    .login-tab.active {
      background: rgba(212, 175, 55, 0.15);
      color: var(--accent-gold-dark);
      border-color: rgba(212, 175, 55, 0.5);
      box-shadow: 0 2px 10px rgba(212, 175, 55, 0.15);
    }

    .collab-form {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 0.5rem;
      margin-top: 0.6rem;
    }

    .collab-form input {
      width: 100%;
      padding: 0.55rem 0.6rem;
      border-radius: 10px;
      border: 1px solid var(--border-soft);
      background: rgba(255,255,255,0.8);
    }

    .collab-form small {
      grid-column: 1 / -1;
      color: var(--text-muted);
    }

    .login-screen {
      max-width: 420px;
      margin: 4rem auto;
      background: var(--bg-card);
      border-radius: 22px;
      padding: 1.5rem 1.7rem 1.3rem;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid rgba(255,255,255,0.95);
    }

    .login-screen h1 {
      font-size: 1.4rem;
      margin-bottom: 0.3rem;
    }

    .login-screen p {
      font-size: 0.9rem;
      color: var(--text-muted);
      margin-bottom: 0.8rem;
    }

    .role-buttons {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.6rem;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      padding: 0.3rem 0.7rem;
      border-radius: 999px;
      background: rgba(0,0,0,0.03);
      font-size: 0.75rem;
      margin-top: 0.2rem;
      color: var(--text-muted);
    }

    .hint {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 0.9rem;
    }

    .hidden {
      display: none !important;
    }

    @media (max-width: 900px) {
      .app-shell {
        flex-direction: column;
      }
      .sidebar {
        width: 100%;
        flex-direction: row;
        align-items: center;
        padding: 0.75rem 1rem;
        overflow-x: auto;
      }
      .sidebar-nav {
        flex-direction: row;
        flex: 1;
        margin-top: 0;
      }
      .sidebar-footer {
        display: none;
      }
      .content {
        padding: 1rem;
      }
      .kiosk-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>

<!-- LOGIN / SELEÇÃO DE PAPEL (SIMULAÇÃO) -->
<section id="login-screen" class="login-screen">
  <h1 id="login-title">Salão Glecie • Painel</h1>
  <p id="login-subtitle">Escolha como deseja acessar o sistema. Depois você pode trocar isso por login real com Firebase.</p>

  <div class="login-mode-toggle">
    <div class="login-tab active" id="tab-ceo" onclick="switchLoginMode('ceo')">Sou a CEO</div>
    <div class="login-tab" id="tab-colab" onclick="switchLoginMode('colab')">Sou colaboradora</div>
  </div>

  <div class="card" id="login-ceo-card" style="margin-top:0.4rem;">
    <h3>Acesso principal (dona do espaço)</h3>
    <p class="subtext">Controle total: agenda, estoque, financeiro e comissões.</p>
    <button style="margin-top:0.5rem;" onclick="setRole('ceo')">Entrar como CEO</button>
  </div>

  <div class="card hidden" id="login-colab-card" style="margin-top:0.4rem;">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:0.5rem;flex-wrap:wrap;">
      <div>
        <h3>Login dedicado da colaboradora</h3>
        <p class="subtext">Tela enxuta: apenas o login desta colaboradora e o acesso ao tablet.</p>
      </div>
      <div class="chip">Criado pela CEO</div>
    </div>
    <div class="collab-form">
      <div>
        <label class="subtext">Usuário</label>
        <input id="collab-login-username" placeholder="ex: camila" />
      </div>
      <div>
        <label class="subtext">Senha</label>
        <input id="collab-login-password" type="password" placeholder="••••••" />
      </div>
      <div>
        <label class="subtext">Dispositivo</label>
        <input id="collab-login-device" placeholder="Tablet da recepção" />
      </div>
      <small>Use o usuário e senha criados na Configuração &gt; Colaboradoras.</small>
    </div>
    <button style="margin-top:0.5rem;" onclick="loginCollaboratorAccount()">Entrar como colaboradora</button>
  </div>

  <div class="card" style="margin-top:0.8rem;">
    <h3>Tablet do cliente (Kiosk)</h3>
    <p class="subtext">Tela fixa para o cliente registrar consumação e o serviço.</p>
    <button style="margin-top:0.5rem;" class="secondary" onclick="setRole('kiosk')">
      Acessar modo tablet
    </button>
    <div class="chip">Ideal para ficar aberto em tela cheia no salão</div>
  </div>

  <p class="hint">
    ⚙️ <strong>Depois</strong>, aqui você troca por autenticação Firebase (email/senha, etc.)
  </p>
</section>

<!-- SHELL PRINCIPAL (CEO / COLAB) -->
<div id="app-shell" class="app-shell hidden">
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo-circle"></div>
      <div>
        <div style="font-size:0.9rem;font-weight:600;">Salão Glecie</div>
        <div id="sidebar-role-label" style="font-size:0.75rem;color:var(--text-muted);">
          —
        </div>
      </div>
    </div>

    <div class="sidebar-nav" id="sidebar-nav">
      <!-- Botões injectados via JS conforme papel -->
    </div>

    <div class="sidebar-footer">
      v0.1 • painel personalizado<br>
      Feito para nail designer.
      <div style="margin-top:0.35rem;">
        <button class="secondary" style="padding:0.3rem 0.7rem;font-size:0.7rem;" onclick="backToLogin()">
          Trocar acesso
        </button>
      </div>
    </div>
  </aside>

  <main class="content">
    <header class="topbar">
      <div>
        <h1 id="page-title">Dashboard</h1>
        <div class="tag" id="page-subtitle">Visão geral do salão</div>
      </div>
      <div style="display:flex;align-items:center;gap:0.6rem;flex-wrap:wrap;">
        <div class="month-visual-toggle">
          <label class="subtext">Filtro mensal</label>
          <select id="dashboard-month-filter" onchange="setDashboardMonth(this.value)"></select>
        </div>
        <button class="secondary" onclick="openKioskFromDashboard()">Abrir modo tablet</button>
      </div>
    </header>

    <!-- Páginas da CEO -->
    <section id="page-ceo-dashboard" class="page-ceo">
      <div class="card-grid">
        <div class="card">
          <h3>Faturamento do mês</h3>
          <div class="value" id="dashboard-revenue">R$ 0,00</div>
          <div class="subtext" id="dashboard-revenue-delta">--</div>
        </div>
        <div class="card">
          <h3>Comissão colaboradora</h3>
          <div class="value" id="dashboard-commission">R$ 0,00</div>
          <div class="subtext" id="dashboard-commission-delta">--</div>
        </div>
        <div class="card">
          <h3>Consumo vendido</h3>
          <div class="value" id="dashboard-consumption">R$ 0,00</div>
          <div class="subtext" id="dashboard-consumption-delta">--</div>
        </div>
        <div class="card">
          <h3>Alertas de estoque</h3>
          <div class="value" id="dashboard-stock-alerts">0</div>
          <div class="subtext" id="dashboard-stock-alerts-desc">Nenhum alerta</div>
        </div>
      </div>

      <div class="section-title" style="margin-top:1rem;">
        <h2>Próximos horários</h2>
        <button class="secondary" onclick="navigatePage('ceo', 'agenda')">Abrir agenda</button>
      </div>
      <table class="table">
        <thead>
          <tr>
            <th>Horário</th>
            <th>Cliente</th>
            <th>Profissional</th>
            <th>Serviço</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>14:00</td>
            <td>Maria Souza</td>
            <td>Glecie</td>
            <td>Manutenção fibra</td>
            <td><span class="badge">Confirmado</span></td>
          </tr>
          <tr>
            <td>16:00</td>
            <td>Ana Paula</td>
            <td>Colaboradora</td>
            <td>Alongamento</td>
            <td><span class="badge">Confirmado</span></td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="page-ceo-agenda" class="page-ceo hidden">
      <div class="section-title">
        <div style="display:flex;align-items:center;gap:0.75rem;flex-wrap:wrap;">
          <h2 style="margin:0;">Agenda</h2>
          <div class="segmented">
            <button id="agenda-toggle-year" class="active" onclick="setAgendaView('year')">Visão anual</button>
            <button id="agenda-toggle-month" onclick="setAgendaView('month')">Mês a mês</button>
          </div>
          <div class="pill-row" style="margin:0;">
            <span class="pill">2025</span>
            <span class="pill">CEO + Colab</span>
          </div>
        </div>
      </div>
      <div id="agenda-view-year">
        <div class="calendar-year" id="year-calendar">
          <!-- Meses preenchidos via JS -->
        </div>
      </div>

      <div id="agenda-view-month" class="hidden">
        <div class="month-visual-toggle" style="margin-bottom:0.4rem;">
          <label class="subtext">Selecione o mês</label>
          <select id="agenda-month-selector" onchange="setSelectedMonth(parseInt(this.value))"></select>
          <div class="tag">Toque nos dias com atendimento para abrir detalhes</div>
        </div>
        <div class="full-month-calendar" id="agenda-month-calendar"></div>
      </div>

      <div class="section-title" style="margin-top:1rem;">
        <h2 id="selected-month-title">Agenda do mês</h2>
        <div class="pill-row" id="selected-month-tags"></div>
      </div>
      <div class="card" style="margin-top:0.2rem;">
        <table class="table" style="margin:0;">
          <thead>
            <tr>
              <th>Dia</th>
              <th>Atendimentos</th>
              <th>Profissionais</th>
              <th>Destaques</th>
            </tr>
          </thead>
          <tbody id="agenda-month-summary">
            <!-- Populado via JS mock -->
          </tbody>
        </table>
      </div>
    </section>

    <section id="page-ceo-inventory" class="page-ceo hidden">
      <div class="inventory-header">
        <div class="inventory-tabs">
          <button id="inventory-tab-btn-polish" class="inventory-tab active" onclick="switchInventoryTab('polish')">Esmaltes</button>
          <button id="inventory-tab-btn-fridge" class="inventory-tab" onclick="switchInventoryTab('fridge')">Geladeira</button>
        </div>
      </div>

      <div id="inventory-panel-polish" class="inventory-tabpanel">
        <div class="section-title">
          <h2>Esmaltes</h2>
          <button onclick="openInventoryModal('polish')">Adicionar</button>
        </div>
        <div class="inventory-list" id="inventory-polish-list">
          <!-- Itens via JS mock -->
        </div>
      </div>

      <div id="inventory-panel-fridge" class="inventory-tabpanel hidden">
        <div class="section-title">
          <h2>Geladeira</h2>
          <button onclick="openInventoryModal('fridge')">Adicionar</button>
        </div>
        <div class="inventory-list" id="inventory-fridge-list">
          <!-- Itens via JS mock -->
        </div>
      </div>
    </section>

    <div id="inventory-modal" class="inventory-modal hidden">
      <div class="card">
        <div class="section-title" style="margin-top:0;">
          <h2 id="inventory-modal-title">Adicionar item</h2>
          <button class="secondary" onclick="closeInventoryModal()">Fechar</button>
        </div>

        <div id="inventory-modal-polish" class="modal-grid">
          <div>
            <label class="subtext">Nome</label>
            <input id="new-polish-name" placeholder="Ex: Nude clássico" />
          </div>
          <div>
            <label class="subtext">Marca</label>
            <input id="new-polish-brand" placeholder="Marca" />
          </div>
          <div>
            <label class="subtext">Volume total (ml)</label>
            <input id="new-polish-total" type="number" placeholder="Ex: 50" />
          </div>
          <div>
            <label class="subtext">Volume atual (ml)</label>
            <input id="new-polish-current" type="number" placeholder="Ex: 30" />
          </div>
        </div>

        <div id="inventory-modal-fridge" class="modal-grid hidden">
          <div>
            <label class="subtext">Item</label>
            <input id="new-fridge-name" placeholder="Ex: Água com gás" />
          </div>
          <div>
            <label class="subtext">Preço de venda</label>
            <input id="new-fridge-price" type="number" placeholder="Ex: 6" />
          </div>
          <div>
            <label class="subtext">Quantidade</label>
            <input id="new-fridge-stock" type="number" placeholder="Ex: 12" />
          </div>
        </div>

        <div class="modal-actions">
          <button class="secondary" onclick="closeInventoryModal()">Cancelar</button>
          <button id="inventory-modal-save" onclick="submitInventoryForm()">Salvar</button>
        </div>
      </div>
    </div>

    <section id="page-ceo-investments" class="page-ceo hidden">
      <div class="section-title">
        <h2>Investimentos do salão</h2>
        <div class="pill-row">
          <span class="pill">Planejamento</span>
          <span class="pill">Compras e reformas</span>
        </div>
      </div>
      <div class="card">
        <div style="display:flex;gap:0.6rem;flex-wrap:wrap;align-items:flex-end;">
          <div>
            <label class="subtext">Título</label>
            <input id="new-invest-title" placeholder="Ex: Nova poltrona" />
          </div>
          <div>
            <label class="subtext">Valor</label>
            <input id="new-invest-amount" type="number" placeholder="500" />
          </div>
          <div>
            <label class="subtext">Categoria</label>
            <input id="new-invest-category" placeholder="Equipamento" />
          </div>
          <button onclick="addInvestment()">Registrar investimento</button>
        </div>
        <table class="table" style="margin-top:0.8rem;">
          <thead>
            <tr>
              <th>Item</th>
              <th>Categoria</th>
              <th>Valor</th>
              <th>Status</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody id="investment-table"></tbody>
        </table>
      </div>
    </section>

    <section id="page-ceo-finance" class="page-ceo hidden">
      <div class="section-title">
        <h2>Resumo financeiro</h2>
        <div class="pill-row">
          <span class="pill">Mês atual</span>
          <span class="pill">Serviços + consumo</span>
        </div>
      </div>

      <div class="card-grid">
        <div class="card">
          <h3>Receita bruta</h3>
          <div class="value">R$ 15.800</div>
          <div class="subtext">Inclui serviços e bebidas</div>
        </div>
        <div class="card">
          <h3>Custos (produtos)</h3>
          <div class="value">R$ 3.100</div>
          <div class="subtext">Baseado no consumo estimado de esmaltes e itens</div>
        </div>
        <div class="card">
          <h3>Lucro estimado</h3>
          <div class="value">R$ 12.700</div>
          <div class="subtext">Antes de outras despesas fixas</div>
        </div>
      </div>

      <div class="section-title" style="margin-top:1rem;">
        <h2>Vendas por tipo</h2>
      </div>
      <table class="table">
        <thead>
          <tr>
            <th>Categoria</th>
            <th>Quantidade</th>
            <th>Valor</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Serviços</td>
            <td>120</td>
            <td>R$ 13.200</td>
          </tr>
          <tr>
            <td>Consumo (geladeira)</td>
            <td>64</td>
            <td>R$ 2.600</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="page-ceo-settings" class="page-ceo hidden">
      <div class="section-title">
        <h2>Configurações do salão</h2>
      </div>
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:0.5rem;flex-wrap:wrap;">
          <div>
            <h3>Colaboradoras e permissões</h3>
            <div class="subtext">Adicione novas profissionais, ajuste comissões e controle o que cada uma pode ver.</div>
          </div>
          <div style="display:flex;gap:0.4rem;">
            <button class="secondary" style="font-size:0.85rem;" onclick="alert('Fluxo de convite mockado')">Adicionar colaboradora</button>
            <button style="font-size:0.85rem;" onclick="alert('Importação mockada')">Importar da ficha</button>
          </div>
        </div>
        <div id="collaborators-list" class="collab-grid"></div>
      </div>

      <div class="card" style="margin-top:0.8rem;">
        <h3>Criar login dedicado para colaboradora</h3>
        <div class="subtext">A CEO registra usuário e senha. A colaboradora só enxerga o próprio login e o botão do tablet.</div>
        <div class="collab-form">
          <div>
            <label class="subtext">Nome da colaboradora</label>
            <input id="new-colab-name" placeholder="Ex: Camila" />
          </div>
          <div>
            <label class="subtext">Usuário</label>
            <input id="new-colab-username" placeholder="Ex: camila" />
          </div>
          <div>
            <label class="subtext">Senha inicial</label>
            <input id="new-colab-password" placeholder="Ex: 123" />
          </div>
          <div>
            <label class="subtext">Permissões</label>
            <input id="new-colab-permissions" placeholder="Agenda compartilhada, comissões" />
          </div>
          <small>Ela poderá alterar a senha depois. Copie este login dedicado para entregar apenas a esta colaboradora.</small>
        </div>
        <div style="display:flex;gap:0.5rem;flex-wrap:wrap;margin-top:0.6rem;">
          <button onclick="createCollaboratorAccount()">Gerar usuário e senha</button>
          <button class="secondary" onclick="switchLoginMode('colab')">Ver tela que ela recebe</button>
        </div>
      </div>

      <div class="card" style="margin-top:0.8rem;">
        <h3>Tabela de serviços</h3>
        <div class="subtext">Valores utilizados no app.</div>
        <table class="table" style="margin-top:0.4rem;">
          <thead>
            <tr>
              <th>Serviço</th>
              <th>Duração</th>
              <th>Preço</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Manutenção fibra</td>
              <td>1h30</td>
              <td>R$ 120</td>
            </tr>
            <tr>
              <td>Alongamento novo</td>
              <td>2h</td>
              <td>R$ 180</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Páginas da COLABORADORA -->
    <section id="page-colab-dashboard" class="page-colab hidden">
      <div class="card-grid">
        <div class="card">
          <h3>Comissão no mês</h3>
          <div class="value">R$ 3.250</div>
          <div class="subtext">Baseada nos serviços realizados</div>
        </div>
        <div class="card">
          <h3>Atendimentos hoje</h3>
          <div class="value">6</div>
          <div class="subtext">3 manhã • 3 tarde</div>
        </div>
      </div>

      <div class="section-title" style="margin-top:1rem;">
        <h2>Próximos horários</h2>
        <button class="secondary" onclick="navigatePage('colab', 'agenda')">Ver agenda completa</button>
      </div>
      <table class="table">
        <thead>
          <tr>
            <th>Horário</th>
            <th>Cliente</th>
            <th>Serviço</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>14:00</td>
            <td>Maria Souza</td>
            <td>Manutenção</td>
            <td><span class="badge">Confirmado</span></td>
          </tr>
          <tr>
            <td>16:00</td>
            <td>Ana Paula</td>
            <td>Alongamento</td>
            <td><span class="badge">Confirmado</span></td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="page-colab-agenda" class="page-colab hidden">
      <div class="section-title">
        <h2>Agenda compartilhada</h2>
        <div class="pill-row">
          <span class="pill">Ver CEO + Colab</span>
        </div>
      </div>
      <table class="table">
        <thead>
          <tr>
            <th>Dia</th>
            <th>Profissional</th>
            <th>Horário</th>
            <th>Cliente</th>
            <th>Serviço</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Hoje</td>
            <td>Glecie</td>
            <td>10:00</td>
            <td>Juliana</td>
            <td>Esmaltação</td>
          </tr>
          <tr>
            <td>Hoje</td>
            <td>Colab</td>
            <td>11:30</td>
            <td>Carla</td>
            <td>Manutenção</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="page-colab-commission" class="page-colab hidden">
      <div class="section-title">
        <h2>Minhas comissões</h2>
        <div class="pill-row">
          <span class="pill">Mês atual</span>
        </div>
      </div>
      <table class="table">
        <thead>
          <tr>
            <th>Data</th>
            <th>Serviço</th>
            <th>Valor serviço</th>
            <th>Comissão</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>02/12</td>
            <td>Manutenção fibra</td>
            <td>R$ 120</td>
            <td>R$ 48</td>
          </tr>
          <tr>
            <td>03/12</td>
            <td>Alongamento</td>
            <td>R$ 180</td>
            <td>R$ 72</td>
          </tr>
        </tbody>
      </table>
    </section>

  </main>
</div>

<!-- TELA KIOSK (CLIENTE) -->
<section id="kiosk-screen" class="hidden">
  <div class="kiosk-wrapper">
    <div class="kiosk-hero">
      <div>
        <h1 style="font-size:1.4rem;">Consumo & Serviço</h1>
        <div class="tag" style="margin-top:0.2rem;">Selecione o que você está consumindo agora</div>
        <div class="kiosk-steps">
          <span class="kiosk-pill">1️⃣ Escolha a bebida</span>
          <span class="kiosk-pill">2️⃣ Marque o serviço</span>
          <span class="kiosk-pill">3️⃣ Confirme e avisa a profissional</span>
        </div>
      </div>
      <button class="secondary" onclick="backToLogin()">Sair do modo tablet</button>
    </div>

    <div class="kiosk-grid">
      <div>
        <h2 class="kiosk-section-title">Bebidas e consumação</h2>
        <div class="kiosk-items" id="kiosk-drinks">
          <!-- Itens via JS -->
        </div>

        <h2 class="kiosk-section-title" style="margin-top:0.8rem;">Serviço que estou fazendo</h2>
        <div class="kiosk-items" id="kiosk-services">
          <!-- Serviços via JS -->
        </div>
      </div>

      <div class="kiosk-cart">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <h2 style="font-size:1rem;">Seu carrinho</h2>
          <button class="secondary" style="font-size:0.75rem;padding:0.3rem 0.7rem;" onclick="clearCart()">
            Limpar
          </button>
        </div>
        <div class="kiosk-cart-list" id="kiosk-cart-list">
          <!-- itens carrinho -->
        </div>
        <div class="kiosk-cart-total">
          <span>Total estimado</span>
          <span id="kiosk-cart-total">R$ 0,00</span>
        </div>
        <button style="margin-top:0.5rem;width:100%;" onclick="sendOrder()">
          Finalizar e avisar a profissional
        </button>
        <div class="hint">
          Depois você paga normalmente no caixa. Este registro ajuda o salão a controlar estoque e comissão.
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  // -----------------------------
  // ESTADO GLOBAL (simples)
  // -----------------------------
  let currentRole = null; // 'ceo' | 'colab' | 'kiosk'
  let currentPageCEO = 'dashboard';
  let currentPageColab = 'dashboard';
  let loginMode = 'ceo';
  let currentColabAccount = null;
  let currentInventoryTab = 'polish';

  const calendarYear = 2025;
  let selectedMonthIndex = new Date().getMonth();
  let agendaViewMode = 'year';
  let selectedDashboardMonth = new Date().getMonth();

  const mockYearDetailed = [
    {
      monthIndex: 0,
      month: 'Jan',
      fullName: 'Janeiro',
      bookings: 90,
      occupancy: 70,
      highlightDays: [2, 8, 14, 22, 29],
      tags: ['Verão cheio', 'Clientes recorrentes'],
      daysSummary: [
        { day: '02/01', count: 6, pros: 'CEO + Colab', highlight: 'Manutenções de viagem' },
        { day: '14/01', count: 8, pros: 'CEO', highlight: 'Agenda cheia' },
        { day: '29/01', count: 7, pros: 'Colab', highlight: 'Promo alongamento' }
      ]
    },
    {
      monthIndex: 1,
      month: 'Fev',
      fullName: 'Fevereiro',
      bookings: 80,
      occupancy: 65,
      highlightDays: [3, 9, 16, 24],
      tags: ['Carnaval', 'Blocos cedo'],
      daysSummary: [
        { day: '03/02', count: 5, pros: 'CEO', highlight: 'Pré-feriado' },
        { day: '16/02', count: 9, pros: 'CEO + Colab', highlight: 'Noivas e formaturas' },
        { day: '24/02', count: 6, pros: 'Colab', highlight: 'Clientes novas' }
      ]
    },
    {
      monthIndex: 2,
      month: 'Mar',
      fullName: 'Março',
      bookings: 110,
      occupancy: 82,
      highlightDays: [5, 12, 18, 27],
      tags: ['Alta procura', 'Eventos corporativos'],
      daysSummary: [
        { day: '05/03', count: 9, pros: 'CEO', highlight: 'Combo fibra + spa' },
        { day: '18/03', count: 10, pros: 'CEO + Colab', highlight: 'Agenda cheia' },
        { day: '27/03', count: 8, pros: 'Colab', highlight: 'Cartão fidelidade' }
      ]
    },
    {
      monthIndex: 3,
      month: 'Abr',
      fullName: 'Abril',
      bookings: 95,
      occupancy: 75,
      highlightDays: [6, 13, 22],
      tags: ['Páscoa', 'Cortes curtos'],
      daysSummary: [
        { day: '06/04', count: 7, pros: 'CEO + Colab', highlight: 'Pacote pós-feriado' },
        { day: '13/04', count: 8, pros: 'CEO', highlight: 'Clientes recorrentes' },
        { day: '22/04', count: 6, pros: 'Colab', highlight: 'Agenda enxuta' }
      ]
    },
    {
      monthIndex: 4,
      month: 'Mai',
      fullName: 'Maio',
      bookings: 105,
      occupancy: 79,
      highlightDays: [3, 9, 17, 25],
      tags: ['Noivas', 'Dia das mães'],
      daysSummary: [
        { day: '03/05', count: 10, pros: 'CEO + Colab', highlight: 'Pacote noiva' },
        { day: '09/05', count: 9, pros: 'CEO', highlight: 'Pré dia das mães' },
        { day: '25/05', count: 7, pros: 'Colab', highlight: 'Agenda equilibrada' }
      ]
    },
    {
      monthIndex: 5,
      month: 'Jun',
      fullName: 'Junho',
      bookings: 88,
      occupancy: 68,
      highlightDays: [4, 12, 19, 28],
      tags: ['Festas juninas', 'Cores quentes'],
      daysSummary: [
        { day: '04/06', count: 6, pros: 'Colab', highlight: 'Esmaltação express' },
        { day: '12/06', count: 8, pros: 'CEO', highlight: 'Dia dos namorados' },
        { day: '28/06', count: 7, pros: 'CEO + Colab', highlight: 'Pós festa junina' }
      ]
    },
    {
      monthIndex: 6,
      month: 'Jul',
      fullName: 'Julho',
      bookings: 120,
      occupancy: 86,
      highlightDays: [2, 10, 18, 26],
      tags: ['Férias', 'Alta ocupação'],
      daysSummary: [
        { day: '02/07', count: 10, pros: 'CEO + Colab', highlight: 'Agenda cheia cedo' },
        { day: '18/07', count: 11, pros: 'CEO', highlight: 'Dia inteiro fibra' },
        { day: '26/07', count: 9, pros: 'Colab', highlight: 'Combo esmaltação + spa' }
      ]
    },
    {
      monthIndex: 7,
      month: 'Ago',
      fullName: 'Agosto',
      bookings: 115,
      occupancy: 83,
      highlightDays: [6, 15, 20, 30],
      tags: ['Retorno aulas', 'Campanha geladeira'],
      daysSummary: [
        { day: '06/08', count: 8, pros: 'CEO', highlight: 'Manutenções escolares' },
        { day: '20/08', count: 10, pros: 'CEO + Colab', highlight: 'Agenda cheia' },
        { day: '30/08', count: 9, pros: 'Colab', highlight: 'Bônus consumação' }
      ]
    },
    {
      monthIndex: 8,
      month: 'Set',
      fullName: 'Setembro',
      bookings: 92,
      occupancy: 72,
      highlightDays: [3, 11, 19, 27],
      tags: ['Primavera', 'Agenda enxuta'],
      daysSummary: [
        { day: '11/09', count: 7, pros: 'Colab', highlight: 'Cores florais' },
        { day: '19/09', count: 8, pros: 'CEO', highlight: 'Clientes recorrentes' },
        { day: '27/09', count: 6, pros: 'CEO + Colab', highlight: 'Sábado light' }
      ]
    },
    {
      monthIndex: 9,
      month: 'Out',
      fullName: 'Outubro',
      bookings: 100,
      occupancy: 77,
      highlightDays: [5, 13, 21, 29],
      tags: ['Primavera', 'Pré feriado'],
      daysSummary: [
        { day: '05/10', count: 9, pros: 'CEO + Colab', highlight: 'Agenda cheia' },
        { day: '21/10', count: 8, pros: 'CEO', highlight: 'Lançamento cor nova' },
        { day: '29/10', count: 7, pros: 'Colab', highlight: 'Dia de reposição' }
      ]
    },
    {
      monthIndex: 10,
      month: 'Nov',
      fullName: 'Novembro',
      bookings: 130,
      occupancy: 88,
      highlightDays: [2, 9, 16, 23, 29],
      tags: ['Black friday', 'Alta demanda'],
      daysSummary: [
        { day: '09/11', count: 11, pros: 'CEO', highlight: 'Pré black' },
        { day: '23/11', count: 12, pros: 'CEO + Colab', highlight: 'Corre de fim de mês' },
        { day: '29/11', count: 10, pros: 'Colab', highlight: 'Extra slots' }
      ]
    },
    {
      monthIndex: 11,
      month: 'Dez',
      fullName: 'Dezembro',
      bookings: 140,
      occupancy: 92,
      highlightDays: [4, 12, 18, 23, 28],
      tags: ['Natal', 'Reveillon'],
      daysSummary: [
        { day: '12/12', count: 12, pros: 'CEO + Colab', highlight: 'Agenda lotada' },
        { day: '23/12', count: 11, pros: 'CEO', highlight: 'Pré natal' },
        { day: '28/12', count: 9, pros: 'Colab', highlight: 'Alongamento viagem' }
      ]
    }
  ];

  let mockPolish = [
    { name: 'Nude Elegante', brand: 'Marca X', current: 30, total: 50, low: false },
    { name: 'Vermelho Clássico', brand: 'Marca Y', current: 10, total: 50, low: true },
    { name: 'Top Coat Brilho', brand: 'Marca Z', current: 12, total: 30, low: true }
  ];

  let mockFridge = [
    { id: 'fridge-coca', name: 'Coca lata', stock: 8, price: 7, low: false, paused: false },
    { id: 'fridge-energetico', name: 'Energético', stock: 3, price: 10, low: true, paused: false },
    { id: 'fridge-agua', name: 'Água sem gás', stock: 15, price: 4, low: false, paused: false }
  ];

  let inventoryFormMode = 'add';
  let inventoryEditingType = 'polish';
  let inventoryEditingIndex = null;

  const monthNamesFull = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];

  const monthlyDashboardStats = [
    { monthIndex: 0, revenue: 12340, commission: 3250, consumption: 640, alerts: 3, alertsDesc: 'Esmalte nude, top coat, energético', delta: '+18% contra Dez' },
    { monthIndex: 1, revenue: 11000, commission: 2980, consumption: 520, alerts: 2, alertsDesc: 'Energético, Coca', delta: '+5% contra Jan' },
    { monthIndex: 2, revenue: 14000, commission: 3650, consumption: 700, alerts: 1, alertsDesc: 'Top coat', delta: '+12% contra Fev' },
    { monthIndex: 3, revenue: 11800, commission: 3100, consumption: 590, alerts: 2, alertsDesc: 'Esmalte vermelho, água', delta: '-8% contra Mar' },
    { monthIndex: 4, revenue: 15000, commission: 4020, consumption: 780, alerts: 1, alertsDesc: 'Top coat', delta: '+9% contra Abr' },
    { monthIndex: 5, revenue: 9800, commission: 2500, consumption: 420, alerts: 3, alertsDesc: 'Esmalte nude, energético, água', delta: '-15% contra Mai' },
    { monthIndex: 6, revenue: 16000, commission: 4300, consumption: 820, alerts: 2, alertsDesc: 'Top coat, Coca', delta: '+18% contra Jun' },
    { monthIndex: 7, revenue: 15800, commission: 4260, consumption: 790, alerts: 2, alertsDesc: 'Top coat, água', delta: '-1% contra Jul' },
    { monthIndex: 8, revenue: 12000, commission: 3200, consumption: 580, alerts: 2, alertsDesc: 'Esmalte nude, energético', delta: '-5% contra Ago' },
    { monthIndex: 9, revenue: 13000, commission: 3350, consumption: 610, alerts: 1, alertsDesc: 'Água', delta: '+3% contra Set' },
    { monthIndex: 10, revenue: 17500, commission: 4700, consumption: 900, alerts: 2, alertsDesc: 'Top coat, energético', delta: '+12% contra Out' },
    { monthIndex: 11, revenue: 19000, commission: 5100, consumption: 980, alerts: 3, alertsDesc: 'Esmalte nude, top coat, energético', delta: '+8% contra Nov' }
  ];

  let investments = [
    { id: 1, title: 'Poltrona reclinável', category: 'Equipamento', amount: 850, status: 'Planejado' },
    { id: 2, title: 'Reforma da recepção', category: 'Obra', amount: 2500, status: 'Em andamento' },
    { id: 3, title: 'Kit iluminação', category: 'Melhoria', amount: 600, status: 'Pago' }
  ];

  const collaborators = [
    { name: 'Glecie', role: 'CEO', commission: 'Recebe total', permissions: 'Agenda, estoque, financeiro', color: '#d4af37', username: 'glecie' },
    { name: 'Camila', role: 'Colaboradora', commission: '40% serviços', permissions: 'Agenda compartilhada, comissões', color: '#f3c06b', username: 'camila' },
    { name: 'Laura', role: 'Colaboradora', commission: '35% serviços', permissions: 'Agenda própria, estoque consulta', color: '#b58c25', username: 'laura' }
  ];

  let collaboratorAccounts = [
    { name: 'Camila', username: 'camila', password: '123', permissions: 'Agenda compartilhada, comissões', device: 'Tablet da recepção' },
    { name: 'Laura', username: 'laura', password: '456', permissions: 'Agenda própria, estoque consulta', device: 'Tablet manicure' },
  ];

  function formatCurrency(value) {
    return 'R$ ' + Number(value || 0).toLocaleString('pt-BR', { minimumFractionDigits: 2 });
  }

  function setupMonthSelects() {
    const agendaSelect = document.getElementById('agenda-month-selector');
    const dashSelect = document.getElementById('dashboard-month-filter');
    if (agendaSelect && agendaSelect.options.length === 0) {
      mockYearDetailed.forEach(m => {
        const opt = document.createElement('option');
        opt.value = m.monthIndex;
        opt.textContent = m.fullName;
        agendaSelect.appendChild(opt);
      });
    }
    if (dashSelect && dashSelect.options.length === 0) {
      monthNamesFull.forEach((name, idx) => {
        const opt = document.createElement('option');
        opt.value = idx;
        opt.textContent = name;
        dashSelect.appendChild(opt);
      });
    }
    if (dashSelect) dashSelect.value = selectedDashboardMonth;
    if (agendaSelect) agendaSelect.value = selectedMonthIndex;
  }

  let kioskDrinks = [];

  const kioskServices = [
    { id: 'manutencao', name: 'Manutenção fibra', price: 120, icon: '💅' },
    { id: 'alongamento', name: 'Alongamento novo', price: 180, icon: '✨' },
    { id: 'esmalta', name: 'Esmaltação simples', price: 50, icon: '🎨' },
  ];

  let cart = [];

  // -----------------------------
  // TROCA DE PAPEL / TELAS
  // -----------------------------
  function setRole(role, account = null) {
    currentRole = role;
    if (role === 'colab') {
      currentColabAccount = account;
    } else {
      currentColabAccount = null;
    }

    document.getElementById('login-screen').classList.add('hidden');
    document.getElementById('app-shell').classList.add('hidden');
    document.getElementById('kiosk-screen').classList.add('hidden');

    if (role === 'ceo' || role === 'colab') {
      document.getElementById('app-shell').classList.remove('hidden');
      setupSidebar(role);
      updateRoleLabel(role);
      updateVisiblePage();
    } else if (role === 'kiosk') {
      document.getElementById('kiosk-screen').classList.remove('hidden');
      renderKiosk();
    }
  }

  function backToLogin() {
    currentRole = null;
    document.getElementById('login-screen').classList.remove('hidden');
    document.getElementById('app-shell').classList.add('hidden');
    document.getElementById('kiosk-screen').classList.add('hidden');
    switchLoginMode(loginMode);
  }

  function openKioskFromDashboard() {
    setRole('kiosk');
  }

  function switchLoginMode(mode) {
    loginMode = mode;
    const ceoCard = document.getElementById('login-ceo-card');
    const colabCard = document.getElementById('login-colab-card');
    const tabCeo = document.getElementById('tab-ceo');
    const tabColab = document.getElementById('tab-colab');
    const title = document.getElementById('login-title');
    const subtitle = document.getElementById('login-subtitle');

    if (!ceoCard || !colabCard) return;

    const isCeo = mode === 'ceo';
    ceoCard.classList.toggle('hidden', !isCeo);
    colabCard.classList.toggle('hidden', isCeo);
    tabCeo.classList.toggle('active', isCeo);
    tabColab.classList.toggle('active', !isCeo);
    title.textContent = isCeo ? 'Salão Glecie • Painel' : 'Login exclusivo da colaboradora';
    subtitle.textContent = isCeo
      ? 'Escolha como deseja acessar o sistema. Depois você pode trocar isso por login real com Firebase.'
      : 'Use apenas o usuário e senha que a CEO criou para você. Aqui não aparece a opção de entrar como CEO.';
  }

  function openCollaboratorLogin(username) {
    const account = collaboratorAccounts.find(acc => acc.username === username);
    backToLogin();
    switchLoginMode('colab');
    if (account) {
      document.getElementById('collab-login-username').value = account.username;
      document.getElementById('collab-login-password').value = account.password;
      document.getElementById('collab-login-device').value = account.device || '';
    }
  }

  function loginCollaboratorAccount() {
    const username = document.getElementById('collab-login-username').value.trim();
    const password = document.getElementById('collab-login-password').value.trim();
    const device = document.getElementById('collab-login-device').value.trim();
    const account = collaboratorAccounts.find(acc => acc.username === username && acc.password === password);
    if (!account) {
      alert('Usuário ou senha inválidos. Confira o login entregue pela CEO.');
      return;
    }
    currentColabAccount = { ...account, device };
    setRole('colab', currentColabAccount);
  }

  function createCollaboratorAccount() {
    const name = document.getElementById('new-colab-name').value.trim();
    const username = document.getElementById('new-colab-username').value.trim();
    const password = document.getElementById('new-colab-password').value.trim();
    const permissions = document.getElementById('new-colab-permissions').value.trim();

    if (!name || !username || !password) {
      alert('Preencha nome, usuário e senha para criar o acesso.');
      return;
    }

    collaboratorAccounts.push({ name, username, password, permissions, device: 'Tablet dedicado' });
    collaborators.push({ name, username, role: 'Colaboradora', commission: '40% serviços', permissions: permissions || 'Agenda compartilhada, comissões', color: '#f1c76d' });

    renderCollaborators();
    document.getElementById('new-colab-name').value = '';
    document.getElementById('new-colab-username').value = '';
    document.getElementById('new-colab-password').value = '';
    document.getElementById('new-colab-permissions').value = '';
    alert(`Login criado para ${name}. Usuário: ${username} | Senha: ${password}`);
  }

  function updateRoleLabel(role) {
    const el = document.getElementById('sidebar-role-label');
    if (role === 'ceo') el.textContent = 'Acesso CEO (total)';
    if (role === 'colab') {
      const label = currentColabAccount ? `${currentColabAccount.name} (colab)` : 'Colaboradora (comissão)';
      el.textContent = label;
    }
  }

  function setupSidebar(role) {
    const nav = document.getElementById('sidebar-nav');
    nav.innerHTML = '';

      if (role === 'ceo') {
        const items = [
          { id: 'dashboard', label: 'Dashboard' },
          { id: 'agenda', label: 'Agenda' },
          { id: 'inventory', label: 'Estoque' },
          { id: 'investments', label: 'Investimentos' },
          { id: 'finance', label: 'Financeiro' },
          { id: 'settings', label: 'Configurações' },
        ];
      items.forEach(item => {
        const btn = document.createElement('button');
        btn.className = 'nav';
        btn.textContent = item.label;
        btn.dataset.page = item.id;
        btn.onclick = () => navigatePage('ceo', item.id);
        nav.appendChild(btn);
      });
      highlightSidebarActive('ceo', currentPageCEO);
    }

    if (role === 'colab') {
      const items = [
        { id: 'dashboard', label: 'Dashboard' },
        { id: 'agenda', label: 'Agenda' },
        { id: 'commission', label: 'Minhas comissões' },
      ];
      items.forEach(item => {
        const btn = document.createElement('button');
        btn.className = 'nav';
        btn.textContent = item.label;
        btn.dataset.page = item.id;
        btn.onclick = () => navigatePage('colab', item.id);
        nav.appendChild(btn);
      });
      highlightSidebarActive('colab', currentPageColab);
    }
  }

  function highlightSidebarActive(role, pageId) {
    const nav = document.getElementById('sidebar-nav');
    const buttons = nav.querySelectorAll('button.nav');
    buttons.forEach(btn => {
      if (btn.dataset.page === pageId) {
        btn.classList.add('active');
      } else {
        btn.classList.remove('active');
      }
    });

    const titleMapCEO = {
      dashboard: ['Dashboard', 'Visão geral do salão'],
      agenda: ['Agenda', 'Visão anual e mensal'],
      inventory: ['Estoque', 'Esmaltes e geladeira'],
      investments: ['Investimentos', 'Compras, reformas e melhorias'],
      finance: ['Financeiro', 'Resumo de receitas e custos'],
      settings: ['Configurações', 'Serviços, comissão, etc.']
    };

    const titleMapColab = {
      dashboard: ['Dashboard', 'Resumo do seu dia'],
      agenda: ['Agenda', 'Sua agenda + CEO'],
      commission: ['Minhas comissões', 'Detalhamento por serviço']
    };

    const titleEl = document.getElementById('page-title');
    const subtitleEl = document.getElementById('page-subtitle');

    if (role === 'ceo') {
      const arr = titleMapCEO[pageId] || ['Dashboard', 'Visão geral do salão'];
      titleEl.textContent = arr[0];
      subtitleEl.textContent = arr[1];
    } else if (role === 'colab') {
      const arr = titleMapColab[pageId] || ['Dashboard', 'Resumo do seu dia'];
      titleEl.textContent = arr[0];
      subtitleEl.textContent = arr[1];
    }
  }

  function navigatePage(role, pageId) {
    if (role === 'ceo') currentPageCEO = pageId;
    if (role === 'colab') currentPageColab = pageId;
    updateVisiblePage();
    highlightSidebarActive(role, pageId);
  }

  function updateVisiblePage() {
    const ceoPages = document.querySelectorAll('.page-ceo');
    const colabPages = document.querySelectorAll('.page-colab');

    ceoPages.forEach(p => p.classList.add('hidden'));
    colabPages.forEach(p => p.classList.add('hidden'));

    if (currentRole === 'ceo') {
      const id = `page-ceo-${currentPageCEO}`;
      const el = document.getElementById(id);
      if (el) el.classList.remove('hidden');
      renderCeoContent();
    }

    if (currentRole === 'colab') {
      const id = `page-colab-${currentPageColab}`;
      const el = document.getElementById(id);
      if (el) el.classList.remove('hidden');
    }
  }

  // -----------------------------
  // RENDERIZAÇÃO DE CONTEÚDO CEO
  // -----------------------------

  function setDashboardMonth(value) {
    selectedDashboardMonth = parseInt(value, 10) || 0;
    renderDashboardCards();
  }

  function renderDashboardCards() {
    const stats = monthlyDashboardStats.find(s => s.monthIndex === selectedDashboardMonth) || monthlyDashboardStats[0];
    const revenueEl = document.getElementById('dashboard-revenue');
    const revenueDelta = document.getElementById('dashboard-revenue-delta');
    const commEl = document.getElementById('dashboard-commission');
    const commDelta = document.getElementById('dashboard-commission-delta');
    const consEl = document.getElementById('dashboard-consumption');
    const consDelta = document.getElementById('dashboard-consumption-delta');
    const alertEl = document.getElementById('dashboard-stock-alerts');
    const alertDesc = document.getElementById('dashboard-stock-alerts-desc');
    const monthLabel = monthNamesFull[stats.monthIndex];

    if (revenueEl) revenueEl.textContent = formatCurrency(stats.revenue);
    if (revenueDelta) revenueDelta.textContent = `${stats.delta} • ${monthLabel}`;
    if (commEl) commEl.textContent = formatCurrency(stats.commission);
    if (commDelta) commDelta.textContent = `Comissão prevista em ${monthLabel}`;
    if (consEl) consEl.textContent = formatCurrency(stats.consumption);
    if (consDelta) consDelta.textContent = 'Geladeira e consumo interno';
    if (alertEl) alertEl.textContent = `${stats.alerts} itens`;
    if (alertDesc) alertDesc.textContent = stats.alertsDesc;
  }

  function setAgendaView(mode) {
    agendaViewMode = mode;
    const yearView = document.getElementById('agenda-view-year');
    const monthView = document.getElementById('agenda-view-month');
    const btnYear = document.getElementById('agenda-toggle-year');
    const btnMonth = document.getElementById('agenda-toggle-month');
    if (yearView && monthView) {
      yearView.classList.toggle('hidden', mode !== 'year');
      monthView.classList.toggle('hidden', mode !== 'month');
    }
    if (btnYear && btnMonth) {
      btnYear.classList.toggle('active', mode === 'year');
      btnMonth.classList.toggle('active', mode === 'month');
    }
    renderAgendaMonthCalendar();
  }

  function renderCeoContent() {
    setupMonthSelects();
    renderDashboardCards();
    renderYearCalendar();
    setAgendaView(agendaViewMode);
    renderAgendaMonthSummary();
    switchInventoryTab(currentInventoryTab);
    renderInventoryLists();
    renderCollaborators();
    renderInvestments();
  }

  function renderYearCalendar() {
    const container = document.getElementById('year-calendar');
    if (!container) return;
    container.innerHTML = '';
    mockYearDetailed.forEach(m => {
      const div = document.createElement('div');
      div.className = 'month-card' + (m.monthIndex === selectedMonthIndex ? ' active' : '');

      const header = document.createElement('div');
      header.className = 'month-header';
      header.innerHTML = `
        <div class="month-name">${m.fullName}</div>
        <div class="month-stat">${m.bookings} atend.</div>
      `;

      const bar = document.createElement('div');
      bar.className = 'month-bar';
      bar.innerHTML = `<div class="month-bar-fill" style="width:${m.occupancy}%;"></div>`;

      const mini = document.createElement('div');
      mini.className = 'mini-calendar';
      mini.innerHTML = `
        <div class="mini-weekdays">
          <span>S</span><span>T</span><span>Q</span><span>Q</span><span>S</span><span>S</span><span>D</span>
        </div>
      `;

      const daysGrid = document.createElement('div');
      daysGrid.className = 'mini-days';
      const days = buildMonthDays(calendarYear, m.monthIndex, m.highlightDays);
      days.forEach(d => {
        const span = document.createElement('span');
        span.className = 'mini-day' + (d.hasBooking ? ' has-booking' : '') + (d.empty ? ' empty' : '');
        span.textContent = d.label;
        if (d.hasBooking) {
          const dot = document.createElement('span');
          dot.className = 'dot';
          span.appendChild(dot);
        }
        daysGrid.appendChild(span);
      });
      mini.appendChild(daysGrid);

      const footnote = document.createElement('div');
      footnote.className = 'month-footnote';
      footnote.innerHTML = `
        <span>Ocupação: ${m.occupancy}%</span>
        <span class="tag">ver mês</span>
      `;

      div.appendChild(header);
      div.appendChild(bar);
      div.appendChild(mini);
      div.appendChild(footnote);
      div.onclick = () => setSelectedMonth(m.monthIndex);
      container.appendChild(div);
    });
  }

  function renderAgendaMonthCalendar() {
    const calendarEl = document.getElementById('agenda-month-calendar');
    const selector = document.getElementById('agenda-month-selector');
    if (selector) selector.value = selectedMonthIndex;
    if (!calendarEl) return;
    calendarEl.innerHTML = '';
    const weekdays = ['S', 'T', 'Q', 'Q', 'S', 'S', 'D'];
    weekdays.forEach(day => {
      const w = document.createElement('div');
      w.className = 'weekday';
      w.textContent = day;
      calendarEl.appendChild(w);
    });
    const month = mockYearDetailed[selectedMonthIndex];
    const days = buildMonthDays(calendarYear, month.monthIndex, month.highlightDays);
    days.forEach(d => {
      const cell = document.createElement('div');
      if (d.empty) {
        cell.style.background = 'transparent';
        calendarEl.appendChild(cell);
        return;
      }
      cell.className = 'month-day' + (d.hasBooking ? ' has-booking' : '');
      cell.innerHTML = `
        <div class="day-number">${d.label}</div>
        ${d.hasBooking ? '<span class="day-badge">Atendimento</span>' : '<span class="day-badge" style="background:transparent;color:var(--text-muted);">Livre</span>'}
      `;
      cell.onclick = () => {
        const match = month.daysSummary.find(day => day.day.startsWith(String(d.label).padStart(2, '0')));
        if (match) alert(`${match.day}: ${match.count} atendimentos • ${match.pros} • ${match.highlight}`);
      };
      calendarEl.appendChild(cell);
    });
  }

  function renderAgendaMonthSummary() {
    const tbody = document.getElementById('agenda-month-summary');
    if (!tbody) return;
    tbody.innerHTML = '';
    const month = mockYearDetailed[selectedMonthIndex];
    const monthTitle = document.getElementById('selected-month-title');
    const tagContainer = document.getElementById('selected-month-tags');
    if (monthTitle) monthTitle.textContent = `Agenda de ${month.fullName}`;
    if (tagContainer) {
      tagContainer.innerHTML = '';
      month.tags.forEach(t => {
        const span = document.createElement('span');
        span.className = 'pill';
        span.textContent = t;
        tagContainer.appendChild(span);
      });
      const ocup = document.createElement('span');
      ocup.className = 'pill';
      ocup.textContent = `${month.occupancy}% ocupação`;
      tagContainer.appendChild(ocup);
    }
    month.daysSummary.forEach(d => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${d.day}</td>
        <td>${d.count} atend.</td>
        <td>${d.pros}</td>
        <td>${d.highlight}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  function setSelectedMonth(index) {
    selectedMonthIndex = index;
    renderYearCalendar();
    renderAgendaMonthCalendar();
    renderAgendaMonthSummary();
  }

  function buildMonthDays(year, monthIndex, highlightDays = []) {
    const result = [];
    const firstWeekday = new Date(year, monthIndex, 1).getDay(); // 0=domingo
    const offset = (firstWeekday + 6) % 7; // força a semana a começar na segunda
    const daysInMonth = new Date(year, monthIndex + 1, 0).getDate();
    for (let i = 0; i < offset; i++) {
      result.push({ empty: true, label: '' });
    }
    for (let d = 1; d <= daysInMonth; d++) {
      result.push({
        label: d,
        hasBooking: highlightDays.includes(d)
      });
    }
    return result;
  }

  function switchInventoryTab(tab) {
    currentInventoryTab = tab;
    const polishPanel = document.getElementById('inventory-panel-polish');
    const fridgePanel = document.getElementById('inventory-panel-fridge');
    const polishBtn = document.getElementById('inventory-tab-btn-polish');
    const fridgeBtn = document.getElementById('inventory-tab-btn-fridge');
    if (polishPanel && fridgePanel) {
      polishPanel.classList.toggle('hidden', tab !== 'polish');
      fridgePanel.classList.toggle('hidden', tab !== 'fridge');
    }
    if (polishBtn && fridgeBtn) {
      polishBtn.classList.toggle('active', tab === 'polish');
      fridgeBtn.classList.toggle('active', tab === 'fridge');
    }
  }

  function resetInventoryForm() {
    document.getElementById('new-polish-name').value = '';
    document.getElementById('new-polish-brand').value = '';
    document.getElementById('new-polish-total').value = '';
    document.getElementById('new-polish-current').value = '';
    document.getElementById('new-fridge-name').value = '';
    document.getElementById('new-fridge-price').value = '';
    document.getElementById('new-fridge-stock').value = '';
  }

  function openInventoryModal(type, mode = 'add', index = null) {
    inventoryFormMode = mode;
    inventoryEditingType = type;
    inventoryEditingIndex = index;
    const modal = document.getElementById('inventory-modal');
    const title = document.getElementById('inventory-modal-title');
    const save = document.getElementById('inventory-modal-save');
    const polishFields = document.getElementById('inventory-modal-polish');
    const fridgeFields = document.getElementById('inventory-modal-fridge');
    resetInventoryForm();
    const isEdit = mode === 'edit';
    if (isEdit && index !== null) {
      if (type === 'polish') {
        const item = mockPolish[index];
        if (item) {
          document.getElementById('new-polish-name').value = item.name;
          document.getElementById('new-polish-brand').value = item.brand;
          document.getElementById('new-polish-total').value = item.total;
          document.getElementById('new-polish-current').value = item.current;
        }
      } else {
        const item = mockFridge[index];
        if (item) {
          document.getElementById('new-fridge-name').value = item.name;
          document.getElementById('new-fridge-price').value = item.price;
          document.getElementById('new-fridge-stock').value = item.stock;
        }
      }
    }
    if (modal) modal.classList.remove('hidden');
    if (title) title.textContent = isEdit
      ? (type === 'polish' ? 'Editar esmalte' : 'Editar item da geladeira')
      : (type === 'polish' ? 'Adicionar esmalte' : 'Adicionar item da geladeira');
    if (save) {
      save.textContent = isEdit ? 'Salvar alterações' : 'Salvar';
      save.onclick = submitInventoryForm;
    }
    if (polishFields && fridgeFields) {
      polishFields.classList.toggle('hidden', type !== 'polish');
      fridgeFields.classList.toggle('hidden', type !== 'fridge');
    }
  }

  function closeInventoryModal() {
    const modal = document.getElementById('inventory-modal');
    inventoryFormMode = 'add';
    inventoryEditingIndex = null;
    inventoryEditingType = 'polish';
    if (modal) modal.classList.add('hidden');
  }

  function getFridgeIcon(name) {
    const lower = name.toLowerCase();
    if (lower.includes('água')) return '🚰';
    if (lower.includes('ener')) return '⚡';
    if (lower.includes('suco')) return '🧃';
    return '🥤';
  }

  function renderInventoryLists() {
    const polishEl = document.getElementById('inventory-polish-list');
    const fridgeEl = document.getElementById('inventory-fridge-list');
    if (polishEl) {
      polishEl.innerHTML = '';
      mockPolish.forEach(p => {
        const pct = Math.round((p.current / p.total) * 100);
        const div = document.createElement('div');
        div.className = 'inventory-card';
        div.innerHTML = `
          <span class="inventory-badge ${p.low ? 'low' : ''}">${p.low ? 'Baixo estoque' : 'OK'}</span>
          <div>
            <div class="inventory-card-title">${p.name}</div>
            <div class="inventory-meta">${p.brand} • ${p.current} ml de ${p.total} ml</div>
          </div>
          <div class="inventory-progress">
            <div class="fill" style="width:${pct}%;"></div>
          </div>
          <div class="inventory-foot">
            <div class="quantity-actions">
              <button onclick="adjustPolish(${mockPolish.indexOf(p)}, -5)">−</button>
              <button onclick="adjustPolish(${mockPolish.indexOf(p)}, 5)">+</button>
            </div>
            <div class="inventory-actions-icons">
              <button class="icon-button" onclick="editPolish(${mockPolish.indexOf(p)})">✎</button>
              <button class="icon-button danger" onclick="removePolish(${mockPolish.indexOf(p)})">🗑</button>
            </div>
          </div>
        `;
        polishEl.appendChild(div);
      });
      if (!mockPolish.length) {
        polishEl.innerHTML = '<div class="inventory-empty">Nenhum esmalte cadastrado.</div>';
      }
    }

    if (fridgeEl) {
      fridgeEl.innerHTML = '';
      mockFridge.forEach(f => {
        const emoji = getFridgeIcon(f.name);
        const stockPct = Math.min(100, Math.max(10, Math.round((f.stock / 20) * 100)));
        const div = document.createElement('div');
        div.className = 'inventory-card';
        div.innerHTML = `
          <span class="inventory-badge ${f.low ? 'low' : ''}">${f.low ? 'Baixo estoque' : 'OK'}</span>
          <div>
            <div class="inventory-card-title">${emoji} ${f.name}</div>
            <div class="inventory-meta">${f.stock} unidades • R$ ${f.price}</div>
          </div>
          <div class="inventory-visibility">
            <span>${f.paused ? 'Pausado no tablet' : 'Visível no tablet'}</span>
            <button class="inventory-toggle ${f.paused ? '' : 'active'}" onclick="toggleFridgeVisibility(${mockFridge.indexOf(f)})">${f.paused ? 'Pausado' : 'Ativo'}</button>
          </div>
          <div class="inventory-progress">
            <div class="fill" style="width:${stockPct}%;"></div>
          </div>
          <div class="inventory-foot">
            <div class="quantity-actions">
              <button onclick="adjustFridge(${mockFridge.indexOf(f)}, -1)">−</button>
              <button onclick="adjustFridge(${mockFridge.indexOf(f)}, 1)">+</button>
            </div>
            <div class="inventory-actions-icons">
              <button class="icon-button" onclick="editFridge(${mockFridge.indexOf(f)})">✎</button>
              <button class="icon-button danger" onclick="removeFridge(${mockFridge.indexOf(f)})">🗑</button>
            </div>
          </div>
        `;
        fridgeEl.appendChild(div);
      });
      if (!mockFridge.length) {
        fridgeEl.innerHTML = '<div class="inventory-empty">Nenhum item na geladeira.</div>';
      }
    }
  }

  function getPolishFormData() {
    const name = document.getElementById('new-polish-name').value.trim();
    const brand = document.getElementById('new-polish-brand').value.trim();
    const total = parseInt(document.getElementById('new-polish-total').value, 10) || 0;
    const current = parseInt(document.getElementById('new-polish-current').value, 10) || 0;
    if (!name || !brand || !total) {
      alert('Preencha nome, marca e volume total.');
      return null;
    }
    return { name, brand, total, current, low: current <= total * 0.2 };
  }

  function getFridgeFormData() {
    const name = document.getElementById('new-fridge-name').value.trim();
    const price = parseFloat(document.getElementById('new-fridge-price').value) || 0;
    const stock = parseInt(document.getElementById('new-fridge-stock').value, 10) || 0;
    if (!name || !price) {
      alert('Preencha o nome e preço do item.');
      return null;
    }
    return { name, price, stock, low: stock < 5 };
  }

  function submitInventoryForm() {
    if (inventoryEditingType === 'polish') {
      const data = getPolishFormData();
      if (!data) return;
      if (inventoryFormMode === 'edit' && inventoryEditingIndex !== null) {
        const existing = mockPolish[inventoryEditingIndex];
        mockPolish[inventoryEditingIndex] = { ...existing, ...data };
      } else {
        mockPolish.push(data);
      }
    } else {
      const data = getFridgeFormData();
      if (!data) return;
      if (inventoryFormMode === 'edit' && inventoryEditingIndex !== null) {
        const existing = mockFridge[inventoryEditingIndex];
        mockFridge[inventoryEditingIndex] = { ...existing, ...data, paused: existing.paused, id: existing.id };
      } else {
        const id = 'fridge-' + Date.now();
        mockFridge.push({ ...data, paused: false, id });
      }
    }
    renderInventoryLists();
    syncKioskFromInventory();
    closeInventoryModal();
  }

  function adjustPolish(index, delta) {
    mockPolish[index].current = Math.max(0, mockPolish[index].current + delta);
    mockPolish[index].low = mockPolish[index].current <= mockPolish[index].total * 0.2;
    renderInventoryLists();
  }

  function editPolish(index) {
    openInventoryModal('polish', 'edit', index);
  }

  function removePolish(index) {
    mockPolish.splice(index, 1);
    renderInventoryLists();
  }

  function adjustFridge(index, delta) {
    mockFridge[index].stock = Math.max(0, mockFridge[index].stock + delta);
    mockFridge[index].low = mockFridge[index].stock < 5;
    renderInventoryLists();
    syncKioskFromInventory();
  }

  function toggleFridgeVisibility(index) {
    mockFridge[index].paused = !mockFridge[index].paused;
    renderInventoryLists();
    syncKioskFromInventory();
  }

  function editFridge(index) {
    openInventoryModal('fridge', 'edit', index);
  }

  function removeFridge(index) {
    mockFridge.splice(index, 1);
    renderInventoryLists();
    syncKioskFromInventory();
  }

  function renderCollaborators() {
    const container = document.getElementById('collaborators-list');
    if (!container) return;
    container.innerHTML = '';
    collaborators.forEach(col => {
      const card = document.createElement('div');
      card.className = 'collab-card';
      card.innerHTML = `
        <div class="collab-headline">
          <div class="collab-avatar" style="background:${col.color}">${col.name[0]}</div>
          <div>
            <strong>${col.name}</strong>
            <div class="collab-meta">${col.role} • ${col.commission}</div>
          </div>
        </div>
        <div class="collab-meta">Permissões: ${col.permissions}</div>
        ${col.username ? `<div class="collab-meta">Login: <strong>${col.username}</strong></div>` : ''}
        <div class="collab-actions">
          <button class="secondary" style="font-size:0.75rem;" onclick="alert('Editar ${col.name}')">Editar perfil</button>
          <button style="font-size:0.75rem;" onclick="alert('Ajustar comissão de ${col.name}')">Comissão</button>
          <button class="secondary" style="font-size:0.75rem;" onclick="alert('Desativar ${col.name}')">Desativar</button>
          ${col.username ? `<button style="font-size:0.75rem;" onclick="openCollaboratorLogin('${col.username}')">Login dedicado</button>` : ''}
        </div>
      `;
      container.appendChild(card);
    });
  }

  function renderInvestments() {
    const tbody = document.getElementById('investment-table');
    if (!tbody) return;
    tbody.innerHTML = '';
    investments.forEach(item => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${item.title}</td>
        <td>${item.category}</td>
        <td>${formatCurrency(item.amount)}</td>
        <td><span class="badge">${item.status}</span></td>
        <td style="display:flex;gap:0.3rem;flex-wrap:wrap;">
          <button class="secondary" style="font-size:0.75rem;" onclick="toggleInvestmentStatus(${item.id})">${item.status === 'Pago' ? 'Reabrir' : 'Marcar pago'}</button>
          <button class="secondary" style="font-size:0.75rem;color:var(--danger);border-color:var(--danger);" onclick="removeInvestment(${item.id})">Remover</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
  }

  function addInvestment() {
    const title = document.getElementById('new-invest-title').value.trim();
    const amount = parseFloat(document.getElementById('new-invest-amount').value) || 0;
    const category = document.getElementById('new-invest-category').value.trim() || 'Geral';
    if (!title || !amount) {
      alert('Preencha título e valor do investimento');
      return;
    }
    const id = Date.now();
    investments.push({ id, title, amount, category, status: 'Planejado' });
    document.getElementById('new-invest-title').value = '';
    document.getElementById('new-invest-amount').value = '';
    document.getElementById('new-invest-category').value = '';
    renderInvestments();
  }

  function toggleInvestmentStatus(id) {
    investments = investments.map(inv => inv.id === id ? { ...inv, status: inv.status === 'Pago' ? 'Planejado' : 'Pago' } : inv);
    renderInvestments();
  }

  function removeInvestment(id) {
    investments = investments.filter(inv => inv.id !== id);
    renderInvestments();
  }

  function syncKioskFromInventory() {
    kioskDrinks = mockFridge
      .filter(item => !item.paused)
      .map(item => ({ id: item.id, name: item.name, price: item.price, icon: getFridgeIcon(item.name) }));
    cart = cart.filter(entry => entry.type !== 'drink' || kioskDrinks.some(d => d.id === entry.id));
    renderKiosk();
  }

  // -----------------------------
  // KIOSK (CLIENTE) - CARRINHO
  // -----------------------------
  function renderKiosk() {
    const drinksEl = document.getElementById('kiosk-drinks');
    const servicesEl = document.getElementById('kiosk-services');
    if (drinksEl) {
      drinksEl.innerHTML = '';
      kioskDrinks.forEach(d => {
        const div = document.createElement('div');
        div.className = 'kiosk-card';
        div.innerHTML = `
          <div class="kiosk-icon">${d.icon || '🥤'}</div>
          <h3>${d.name}</h3>
          <div class="kiosk-price">R$ ${d.price}</div>
          <div class="kiosk-badge">Consumo imediato</div>
          <button style="margin-top:0.5rem;" onclick="addDrinkToCart('${d.id}')">Adicionar</button>
        `;
        drinksEl.appendChild(div);
      });
    }
    if (servicesEl) {
      servicesEl.innerHTML = '';
      kioskServices.forEach(s => {
        const div = document.createElement('div');
        div.className = 'kiosk-card';
        div.innerHTML = `
          <div class="kiosk-icon">${s.icon || '💅'}</div>
          <h3>${s.name}</h3>
          <div class="kiosk-price">R$ ${s.price}</div>
          <div class="kiosk-badge">Serviço principal</div>
          <button style="margin-top:0.5rem;" onclick="selectService('${s.id}')">Selecionar</button>
        `;
        servicesEl.appendChild(div);
      });
    }
    renderCart();
  }

  function addDrinkToCart(drinkId) {
    const drink = kioskDrinks.find(d => d.id === drinkId);
    if (!drink) return;
    cart.push({ type: 'drink', id: drink.id, name: drink.name, price: drink.price });
    renderCart();
  }

  function selectService(serviceId) {
    const service = kioskServices.find(s => s.id === serviceId);
    if (!service) return;
    // Remove serviços anteriores do carrinho
    cart = cart.filter(item => item.type !== 'service');
    cart.push({ type: 'service', id: service.id, name: service.name, price: service.price });
    renderCart();
  }

  function removeFromCart(index) {
    cart.splice(index, 1);
    renderCart();
  }

  function clearCart() {
    cart = [];
    renderCart();
  }

  function calcTotalCart() {
    return cart.reduce((sum, item) => sum + item.price, 0);
  }

  function renderCart() {
    const listEl = document.getElementById('kiosk-cart-list');
    const totalEl = document.getElementById('kiosk-cart-total');
    if (!listEl || !totalEl) return;

    listEl.innerHTML = '';
    cart.forEach((item, index) => {
      const div = document.createElement('div');
      div.className = 'kiosk-cart-item';
      const label = item.type === 'drink' ? 'Consumo' : 'Serviço';
      div.innerHTML = `
        <div>
          <strong>${item.name}</strong>
          <div class="subtext" style="margin-top:0.1rem;">${label}</div>
        </div>
        <div style="text-align:right;">
          <div>R$ ${item.price}</div>
          <button class="secondary" style="padding:0.15rem 0.5rem;font-size:0.7rem;margin-top:0.15rem;"
            onclick="removeFromCart(${index})">
            Remover
          </button>
        </div>
      `;
      listEl.appendChild(div);
    });

    totalEl.textContent = 'R$ ' + calcTotalCart().toFixed(2).replace('.', ',');
  }

  function sendOrder() {
    if (cart.length === 0) {
      alert('Adicione pelo menos um item ao carrinho.');
      return;
    }

    // TODO: aqui você envia o cart para o Firestore:
    // - criar documento em "orders" com items, horário, etc.
    // - atualizar estoque (via Cloud Function)
    // Exemplo (pseudo):
    // await addDoc(collection(db, "orders"), { items: cart, createdAt: serverTimestamp(), ... })

    alert('Pedido registrado! A profissional será avisada.');
    clearCart();
  }

  // Inicialização
  // (poderia detectar login real do Firebase aqui)
  syncKioskFromInventory();
  switchLoginMode('ceo');
</script>

</body>
</html>
